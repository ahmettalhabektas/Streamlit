import os
import random
import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd
import streamlit as st
import pickle
from pathlib import Path


# Set the page configuration
st.set_page_config(
    page_title="ğŸš¢ Titanic Survival Predictor ğŸš¢",
    page_icon="ğŸš¢",
    layout="centered",
    initial_sidebar_state="expanded",
    menu_items={
        'Get Help': None,
        'Report a bug': None,
        'About':
        """ ## Welcome to the Titanic Survival Predictor! ğŸŒŸ
        This app uses AI to estimate your chances of survival on the Titanic. Feel free to contact me if you have any questions or feedback:
        - ğŸ“§ My email: [atalhabektas@gmail.com](mailto:atalhabektas@gmail.com)
        - ğŸ”— My LinkedIn: [Ahmet Talha BektaÅŸ](https://www.linkedin.com/in/ahmet-talha-bekta%C5%9F-056844216)
        - ğŸ’» My GitHub: [Ahmet Talha BektaÅŸ](https://github.com/ahmettalhabektas)
        - ğŸ‘¨â€ğŸ’» My Kaggle: [Ahmet Talha BektaÅŸ](https://www.kaggle.com/ahmettalhabektas)
        Made with ğŸ’– by [Ahmet Talha BektaÅŸ](https://www.linkedin.com/in/ahmet-talha-bekta%C5%9F-056844216)
        """
    }
)

# Read the Titanic dataset
#titanic = pd.read_csv(CSV_PATH)
PATH = "https://raw.githubusercontent.com/ahmettalhabektas/Streamlit/master/Titanic_Streamlit/data/titanic.csv"
titanic = pd.read_csv(PATH)


# Language selection
lang = st.selectbox("ğŸŒ Please select a language", options=( "ğŸ‡¬ğŸ‡§ English","ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e"))
lang = lang.split(" ")[1]

if lang == "English":
    # English Content
    st.markdown("# Embark on a Titanic Adventure ğŸš¢")
    st.write(
        "Welcome aboard the RMS Titanic, a legendary British passenger liner with a captivating story! Join us as we journey back in time to April 1912, "
        "when this magnificent ship set sail on its maiden voyage, only to meet a chilling fate. Brace yourself for some exciting Titanic trivia:"
    )
    st.image("https://upload.wikimedia.org/wikipedia/commons/thumb/6/6e/St%C3%B6wer_Titanic.jpg/800px-St%C3%B6wer_Titanic.jpg", caption="RMS Titanic ğŸ“¸")

    st.subheader("Get Ready for Some Titanic Trivia â„¹ï¸:")
    st.markdown(
        "- Meet the Titanic, one of three Olympic-class ocean liners operated by the famous White Star Line. ğŸš¢"
    )
    st.markdown(
        "- Picture this: April 14, 1912, a moonlit night, and suddenly, an iceberg! The Titanic's ill-fated encounter sent her plunging into the icy depths of the North Atlantic Ocean on April 15, 1912. â„ï¸ğŸŒŠ"
    )
    st.markdown(
        "- Hold onto your seats! More than 1,500 brave souls lost their lives in this heart-wrenching disaster, marking it as one of the most tragic peacetime maritime events in history. â˜ ï¸"
    )
    st.markdown(
        "- The Titanic was a marvel of its time, equipped with advanced safety features like watertight compartments and lifeboats. But, alas, there weren't enough lifeboats for everyone! ğŸ†˜ğŸ›¶"
    )

    st.write(
        "Join us in exploring the incredible history of the Titanic, where adventure meets tragedy, and learn how you would have fared on this unforgettable voyage!"
    )


    st.markdown("# Titanic Survival Prediction ğŸ§‘â€ğŸš€")
    st.write(
        "Welcome to the Titanic Survival Predictor! Let's take a journey into the AI world and predict your fate if you were on the Titanic. Exciting, right? ğŸš¢"
    )

    with st.expander("How Does Our AI Model Work? âœ¨"):
        st.markdown("# How Does the AI Model Work? ğŸ¤–âœ¨")

        st.write(
            "Welcome to the Titanic Survival Prediction! ğŸš¢ These predictions are generated by an Artificial Intelligence model. Our model has an accuracy rate of approximately 80%, and we use the Random Forest classification algorithm to make predictions."
        )

        st.markdown(
            "The Random Forest classification algorithm is a versatile model created by combining numerous decision trees. ğŸŒ²ğŸŒ²ğŸŒ² These trees are trained using random data samples and features. The model combines the predictions from these trees to produce results. ğŸŒ³ğŸ”®"
        )

        st.markdown(
            "The Random Forest algorithm is used to predict the survival of Titanic passengers. The model takes into account passengers' personal information, ticket class, gender, age, and more to make predictions. ğŸ«ğŸ‘«ğŸ“†"
        )

        st.markdown(
            "However, please keep in mind that these predictions are merely estimates, and real-life outcomes can be influenced by various factors. While our model has an accuracy rate of approximately 80%, the results are not definitive and are for entertainment purposes only. ğŸ‰ğŸ¤ª"
        )



    st.write(
        "Go ahead and fill out the form, then click the 'Submit' button to see your prediction! ğŸš€"
    )

    with st.expander("Feeling Adventurous? Fill Out the Form! ğŸš€",expanded=True):
        st.write(
            "ğŸŒŸ Ahoy there! Welcome aboard the Titanic adventure! We're setting sail on a journey through time, and you're invited to be a part of it. "
            "Picture yourself as a passenger on the grand RMS Titanic. We'll use our AI magic to predict whether you'd survive this legendary voyage."
        )

        st.write(
            "ğŸ•°ï¸ But before we embark on this thrilling quest, let's put on our virtual time-traveler hats and gather some essential information."
        )

        st.write(
            "ğŸ“ Fear not, it's not just a regular form; it's your ticket to the Titanic experience! Fill in your details like your name, age, gender, and more, "
            "and we'll do the rest. Will you make it to the lifeboats, or will you brave the icy waters of the North Atlantic? Let's uncover the adventure!"
        )

        st.write(
            "ğŸš¢ Keep in mind, this is all for fun and the love of adventure. Our AI model will make a prediction, but the real excitement lies in your imagination. Are you ready to set sail?"
        )

        success_control = False

    
            
        user_name_holder = ""
        user_surname_holder = ""
        pclass_holder = 1
        age_holder = 0
        sib_holder = 0
        sp_holder = 0
        par_holder = 0
        ch_holder = 0
        sex_holder = 0
        fare_holder = 0
        embarked_holder = 0
        deck_letter_holder = 0

 



        col1, col2 = st.columns(2)
        user_name = col1.text_input("Your First Name âœï¸", max_chars=50, placeholder="Enter your first name",value=user_name_holder)
        user_surname = col2.text_input("Your Last Name âœï¸", max_chars=50, placeholder="Enter your last name",value=user_surname_holder)

        pclass = st.radio("Choose Your Passenger Class ğŸš¢", options=(1, 2, 3),index=pclass_holder-1)

        age = st.slider("Your Age ğŸ‚", min_value=0, max_value=85, value=age_holder)

        sib = st.slider("Number of Siblings Aboard ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦", min_value=0, max_value=5, value=sib_holder)

        sp = st.slider("Number of Spouses Aboard ğŸ‘©â€â¤ï¸â€ğŸ‘¨", min_value=0, max_value=5, value=sp_holder)

        sib_sp = sib + sp

        par = st.slider("Number of Parents Aboard ğŸ‘ª", min_value=0, max_value=5, value=par_holder)

        ch = st.slider("Number of Children Aboard ğŸ‘¶", min_value=0, max_value=5, value=ch_holder)

        parch = par + ch

        num_family = parch + sib_sp + 1

        sex = st.selectbox("Your Gender ğŸ‘©â€ğŸ¦°ğŸ‘¨â€ğŸ¦±", options=("Female", "Male"), index=sex_holder)

        min_fare = titanic.loc[titanic["Pclass"] == pclass, "Fare"].min()
        max_fare = titanic.loc[titanic["Pclass"] == pclass, "Fare"].max()

        st.write("ğŸ’° The range of Fare is calculated based on your Passenger class")

        fare = st.slider(f"ğŸ’· Ticket Price in British Pounds (Â£) between {min_fare} and {max_fare}", min_value=float(min_fare), max_value=float(max_fare), value=float(fare_holder))

        embarked = st.selectbox("Port of Embarkation ğŸš¢", options=("Cherbourg (C)", "Southampton (S)", "Queenstown (Q)"), index=embarked_holder)

        st.write("ğŸš¢ The Titanic has decks labeled from A (top) to F (bottom), with 'U' representing unknown decks. The available deck options are calculated based on your chosen passenger class.")

        deck_options = titanic.loc[titanic["Pclass"] == pclass, "Deck_letter"].unique().tolist()
        deck_letter = st.selectbox("Deck Letter ğŸš¢", options=(deck_options), index=deck_letter_holder)

        submit, _, _, _, randomizer = st.columns(5)

        if submit.button("Submit âœ…"):
            if age == 0:
                st.warning("Please fill in the required fields â¬†ï¸")
            else:
                st.success("Submitted Successfully! ğŸ‘")
                success_control = True


        if success_control:
            # Create a dictionary with scalar values and specify an index
            data = {
                'Pclass': [pclass],
                'Age': [age],
                'SibSp': [sib_sp],
                'Parch': [parch],
                'Fare': [fare],
                'NumFamily': [num_family],
                'Sex_female': [0],
                'Sex_male': [0],
                'Embarked_C': [0],
                'Embarked_Q': [0],
                'Embarked_S': [0],
                'Deck_letter_A': [0],
                'Deck_letter_B': [0],
                'Deck_letter_C': [0],
                'Deck_letter_D': [0],
                'Deck_letter_E': [0],
                'Deck_letter_F': [0],
                'Deck_letter_G': [0],
                'Deck_letter_U': [0],
            }

            # Specify an index for the DataFrame
            index = [0]  # You can adjust the index as needed

            df = pd.DataFrame(data, index=index)

            embarked = embarked[0]
            df[f"Embarked_{embarked}"] = 1

            df[f"Sex_{sex.lower()}"] = 1

            df[f"Deck_letter_{deck_letter}"] = 1

            # Load the model from the pickle file
            with open('model.pkl', 'rb') as file:
                model = pickle.load(file)

            # Make predictions using the loaded model
            predictions = model.predict(df)

            # Specify the directory where your files are located
            alive_directory_path = "alive"
            dead_directory_path = "dead"

            # List all files in the directory
            alive_files = os.listdir(alive_directory_path)

            # Filter files to exclude directories (if any)
            alive_files = [file for file in alive_files if os.path.isfile(os.path.join(alive_directory_path, file))]

            # List all files in the directory
            dead_files = os.listdir(dead_directory_path)

            # Filter files to exclude directories (if any)
            dead_files = [file for file in dead_files if os.path.isfile(os.path.join(dead_directory_path, file))]

            image_place = st.empty()

            if predictions[0] == 0:
                st.write("ğŸŒŠ Oh no! It seems you didn't make it to a lifeboat. But remember, it's all in good fun!")
                chosen_dead_file = os.path.join(dead_directory_path, random.choice(dead_files))
                image_place.image(chosen_dead_file, width=675)





                
            elif predictions[0] == 1:
                st.write("ğŸ‰ Congratulations! You've survived the Titanic adventure! Now, imagine the thrilling stories you'd have to tell!")
                          
                chosen_alive_file = os.path.join(alive_directory_path, random.choice(alive_files))
                image_place.image(chosen_alive_file, width=675)




            else:
                st.warning("A problem occured")



    st.write("I bet you're itching to uncover the secrets hidden in Titanic's data, right? Well, get ready for a thrilling data-driven adventure with some cool graphs!")

    with st.expander("Let's Dive into Data Visualization ğŸ“Š"):
        st.write(
            "Hold onto your life jackets because we're about to embark on a thrilling adventure through Titanic's data!"
        )

        st.markdown(
            "ğŸ‰ **Discover the Titanic's Secrets**: Imagine being Sherlock Holmes on the Titanic! We'll uncover how passenger class, gender, and age played roles in who survived. Get ready to unveil the mysteries!"
        )

        st.markdown(
            "ğŸš€ **Blast Off with Graphs**: Our secret weapon? Powerful graphs! They're like magic windows into the Titanic's history. Buckle up for a rocket ride!"
        )

        st.markdown(
            "ğŸ’¡ **Get Insights**: These visualizations will provide insights that even Jack and Rose from the movie would find fascinating. Are you ready for this data-driven adventure? The Titanic's secrets await!"
        )

        st.write("Hit that 'Create Graphs' button below, and let's set sail!")

        bins = list(range(0, 81, 5))  # Creates bins from 0 to 80 with a step of 5

        # Use pd.cut to categorize the data into the specified bins
        titanic['Age Range'] = pd.cut(titanic['Age'], bins=bins, right=True)

        bins = list(range(0, 300, 20))  # Creates bins from 0 to 80 with a step of 5

        # Use pd.cut to categorize the data into the specified bins
        titanic['Fare Range'] = pd.cut(titanic['Fare'], bins=bins, right=True)

        st.write("If you're curious about the real statistics of the Titanic dataset, let's dive in together.")

        user_hue = st.selectbox("What should we use for color encoding?", options=("None", "Survived", "Passenger Class", "Sex", "Age Range", "Siblings & Spouses", "Parents & Children", "Fare Range", "Port of Embarkation", "Deck Letter"))
        user_x = st.selectbox("Choose a value for the x-axis", options=("Survived", "Passenger Class", "Sex", "Siblings & Spouses", "Parents & Children", "Port of Embarkation", "Deck Letter"))

        if user_hue == "None":
            user_hue = None
        titanic.Survived = titanic.Survived.replace([1, 0], ["Survived ğŸ˜Š", "Not Survived ğŸ˜¥"])
        titanic = titanic.rename(columns={"Pclass": "Passenger Class", "SibSp": "Siblings & Spouses", "Parch": "Parents & Children", "Embarked": "Port of Embarkation","Deck_letter":"Deck Letter"})
        fig = plt.figure()
        plot_df = titanic.copy()
        sns.countplot(data=plot_df, x=user_x, hue=user_hue)
        if st.button("Create Graph"):
            st.pyplot(fig)


else:
    # Turkish Content
    st.markdown("# Titanik MacerasÄ±na HoÅŸ Geldiniz ğŸš¢")
    st.write(
        "Legandary British yolcu gemisi RMS Titanic'e hoÅŸ geldiniz! Bu bÃ¼yÃ¼leyici geminin ilginÃ§ hikayesine yolculuk ediyoruz. Bize katÄ±lÄ±n ve bu muhteÅŸem geminin ilk seferine, Nisan 1912'ye geri dÃ¶nelim, "
        "Ancak maalesef korkunÃ§ bir kaderle karÅŸÄ±laÅŸan bu seyahati yaparken heyecan verici Titanik bilgileriyle hazÄ±rlÄ±klÄ± olun:"
    )
    st.image("https://upload.wikimedia.org/wikipedia/commons/thumb/6/6e/St%C3%B6wer_Titanic.jpg/800px-St%C3%B6wer_Titanic.jpg", caption="RMS Titanic ğŸ“¸")

    st.subheader("Titanik Bilgileri Ä°Ã§in HazÄ±r Olun â„¹ï¸:")
    st.markdown(
        "- ÃœnlÃ¼ White Star Line tarafÄ±ndan iÅŸletilen Ã¼Ã§ Olympic sÄ±nÄ±fÄ± okyanus gemisinden biri olan Titanik'i tanÄ±yÄ±n. ğŸš¢"
    )
    st.markdown(
        "- ÅÃ¶yle dÃ¼ÅŸÃ¼nÃ¼n: 14 Nisan 1912, aydÄ±nlÄ±k bir gece ve birdenbire bir buzdaÄŸÄ±! Titanik'in talihsiz karÅŸÄ±laÅŸmasÄ±, onu 15 Nisan 1912'de Kuzey Atlantik Okyanusu'nun buz gibi sularÄ±na gÃ¶nderdi. â„ï¸ğŸŒŠ"
    )
    st.markdown(
        "- KoltuklarÄ±nÄ±za sÄ±kÄ±ca tutun! Bu yÃ¼rek burkan felakette 1.500'den fazla cesur insan hayatÄ±nÄ± kaybetti ve bu, tarih boyunca kaydedilmiÅŸ en trajik barÄ±ÅŸ zamanÄ± deniz olaylarÄ±ndan biri olarak kabul ediliyor. â˜ ï¸"
    )
    st.markdown(
        "- Titanik, dÃ¶neminin bir harikasÄ±ydÄ± ve su geÃ§irmez bÃ¶lmeler ve cankurtaran botlar gibi geliÅŸmiÅŸ gÃ¼venlik Ã¶zelliklerine sahipti. Ama ne yazÄ±k ki, herkes iÃ§in yeterli cankurtaran bot yoktu! ğŸ†˜ğŸ›¶"
    )

    st.write(
        "Titanik'in inanÄ±lmaz tarihini keÅŸfetmek iÃ§in bize katÄ±lÄ±n, macera ve trajedinin buluÅŸtuÄŸu bu unutulmaz yolculukta nasÄ±l bir performans sergilediÄŸinizi Ã¶ÄŸrenin!"
    )

    # Turkish Content
    st.markdown("# Titanic Hayatta Kalma Tahmini ğŸ§‘â€ğŸš€")
    st.write(
        "Titanik Hayatta Kalma Tahminine hoÅŸ geldiniz! AI dÃ¼nyasÄ±na bir yolculuk yapalÄ±m ve Titanik'te olsaydÄ±nÄ±z kaderinizi tahmin edelim. HeyecanlÄ± deÄŸil mi? ğŸš¢"
    )

    with st.expander("Yapay Zeka modelimiz nasÄ±l Ã§alÄ±ÅŸÄ±yor? âœ¨"):
        st.markdown("# Yapay Zeka Modeli NasÄ±l Ã‡alÄ±ÅŸÄ±yor? ğŸ¤–âœ¨")

        st.write(
            "Titanik Hayatta Kalma Tahminine hoÅŸ geldiniz! ğŸš¢ Bu tahminler, bir Yapay Zeka modeli tarafÄ±ndan Ã¼retilmektedir. Modelimizin doÄŸruluk oranÄ± yaklaÅŸÄ±k %80'dir ve sonuÃ§larÄ± tahmin etmek iÃ§in Random Forest sÄ±nÄ±flandÄ±rma algoritmasÄ± kullanÄ±yoruz."
        )

        st.markdown(
            "Random Forest sÄ±nÄ±flandÄ±rma algoritmasÄ±, Ã§ok sayÄ±da karar aÄŸacÄ±nÄ±n bir araya getirilmesiyle oluÅŸturulan bir ansiklopedik modeldir. ğŸŒ²ğŸŒ²ğŸŒ² Bu aÄŸaÃ§lar, rastgele veri Ã¶rnekleri ve Ã¶zellikler kullanÄ±larak eÄŸitilir. Model, bu aÄŸaÃ§larÄ±n tahminlerini bir araya getirerek sonuÃ§larÄ± Ã¼retir. ğŸŒ³ğŸ”®"
        )

        st.markdown(
            "Random Forest algoritmasÄ±, Titanik yolcularÄ±nÄ±n hayatta kalma tahminlerini yapmak iÃ§in kullanÄ±lÄ±yor. Model, yolcularÄ±n kiÅŸisel bilgileri, bilet sÄ±nÄ±fÄ±, cinsiyet, yaÅŸ, ve daha fazlasÄ±nÄ± dikkate alarak tahminlerde bulunur. ğŸ«ğŸ‘«ğŸ“†"
        )

        st.markdown(
            "Ancak unutmayÄ±n ki bu tahminler sadece bir Ã¶ngÃ¶rÃ¼dÃ¼r ve gerÃ§ek hayatta Ã§ok sayÄ±da faktÃ¶r etkileyebilir. Modelimizin doÄŸruluk oranÄ± %80 olsa da, sonuÃ§lar kesin deÄŸildir ve yalnÄ±zca eÄŸlence amaÃ§lÄ±dÄ±r. ğŸ‰ğŸ¤ª"
        )


    # Turkish Content
    st.write(
        "Formu doldurun ve tahmininizi gÃ¶rmek iÃ§in 'GÃ¶nder' dÃ¼ÄŸmesine tÄ±klayÄ±n! ğŸš€"
    )

    with st.expander("Macera Dolu Musunuz? Formu Doldurun! ğŸš€",expanded=True):
        st.write(
            "ğŸŒŸ Ahoy oraya! Titanik macerasÄ±na hoÅŸ geldiniz! Zaman yolculuÄŸuna Ã§Ä±kÄ±yoruz ve siz de bu yolculuÄŸun bir parÃ§asÄ± olmaya davetlisiniz. "
            "Kendinizi bÃ¼yÃ¼k RMS Titanic'in bir yolcusu olarak hayal edin. AI sihirlerimizi kullanarak bu efsanevi yolculukta hayatta kalÄ±p kalmayacaÄŸÄ±nÄ±zÄ± tahmin edeceÄŸiz."
        )

        st.write(
            "ğŸ•°ï¸ Ancak bu heyecanlÄ± maceraya baÅŸlamadan Ã¶nce sanal zaman yolcusu ÅŸapkalarÄ±mÄ±zÄ± takalÄ±m ve bazÄ± temel bilgileri toplayalÄ±m."
        )

        st.write(
            "ğŸ“ EndiÅŸelenmeyin, bu sÄ±radan bir form deÄŸil; bu, Titanik deneyiminiz iÃ§in bir bilet! Ä°sminiz, yaÅŸÄ±nÄ±z, cinsiyetiniz ve daha fazlasÄ± gibi detaylarÄ± doldurun, "
            "gerisini biz hallederiz. Can yeleklerine mi ulaÅŸacaksÄ±nÄ±z, yoksa Kuzey Atlantik'in buzlu sularÄ±na cesurca mÄ± meydan okuyacaksÄ±nÄ±z? MacerayÄ± keÅŸfetmeye hazÄ±r mÄ±sÄ±nÄ±z!"
        )

        st.write(
            "ğŸš¢ UnutmayÄ±n, bu tamamen eÄŸlence ve macera aÅŸkÄ± iÃ§indir. AI modelimiz bir tahmin yapacak, ancak gerÃ§ek heyecan hayal gÃ¼cÃ¼nÃ¼zde yatÄ±yor. HazÄ±r mÄ±sÄ±nÄ±z denize aÃ§Ä±lmaya?"
        )



        user_name_holder = ""
        user_surname_holder = ""
        pclass_holder = 1
        age_holder = 0
        sib_holder = 0
        sp_holder = 0
        par_holder = 0
        ch_holder = 0
        sex_holder = 0
        fare_holder = 0
        embarked_holder = 0
        deck_letter_holder = 0


        success_control = False
        col1, col2 = st.columns(2)
        user_name = col1.text_input("AdÄ±nÄ±zÄ± Girin âœï¸", max_chars=50, placeholder="AdÄ±nÄ±zÄ± girin",value=user_name_holder)
        user_surname = col2.text_input("SoyadÄ±nÄ±zÄ± Girin âœï¸", max_chars=50, placeholder="SoyadÄ±nÄ±zÄ± girin",value=user_surname_holder)

        pclass = st.radio("Yolcu SÄ±nÄ±fÄ±nÄ±zÄ± SeÃ§in ğŸš¢", options=(1, 2, 3), index=pclass_holder-1)

        age = st.slider("YaÅŸÄ±nÄ±zÄ± Girin ğŸ‚", min_value=0, max_value=85, value=age_holder)

        sib = st.slider("Gemideki KardeÅŸler SayÄ±sÄ± ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦", min_value=0, max_value=5, value=sib_holder)
        sp = st.slider("Gemideki EÅŸler SayÄ±sÄ± ğŸ‘©â€â¤ï¸â€ğŸ‘¨", min_value=0, max_value=5, value=sp_holder)

        sib_sp = sib + sp

        par = st.slider("Gemideki Ebeveynler SayÄ±sÄ± ğŸ‘ª", min_value=0, max_value=5, value=par_holder)
        ch = st.slider("Gemideki Ã‡ocuklar SayÄ±sÄ± ğŸ‘¶", min_value=0, max_value=5, value=ch_holder)

        parch = par + ch

        num_family = parch + sib_sp + 1

        sex = st.selectbox("Cinsiyetiniz ğŸ‘©â€ğŸ¦°ğŸ‘¨â€ğŸ¦±", options=("KadÄ±n", "Erkek"), index=sex_holder)

        min_fare = titanic.loc[titanic["Pclass"] == pclass, "Fare"].min()
        max_fare = titanic.loc[titanic["Pclass"] == pclass, "Fare"].max()

        st.write("ğŸ’° Bilet fiyatÄ± aralÄ±ÄŸÄ±, Yolcu SÄ±nÄ±fÄ±nÄ±za gÃ¶re hesaplanÄ±r")

        fare = st.slider(f"ğŸ’· Ä°ngiliz Sterlini (Â£) cinsinden Bilet FiyatÄ±, {min_fare} ile {max_fare} arasÄ±nda", min_value=min_fare, max_value=max_fare, value=float(fare_holder))

        embarked = st.selectbox("BiniÅŸ LimanÄ± ğŸš¢", options=("Cherbourg (C)", "Southampton (S)", "Queenstown (Q)"), index=embarked_holder)

        st.write("ğŸš¢ Titanik, A (en Ã¼st) ile F (en alt) arasÄ±nda numaralandÄ±rÄ±lmÄ±ÅŸ gÃ¼vertelere sahipti ve 'U'  gÃ¼verteleri bilinmeyen yolcularÄ± temsil eder. KullanÄ±labilir gÃ¼verte seÃ§enekleri, seÃ§tiÄŸiniz yolcu sÄ±nÄ±fÄ±na gÃ¶re hesaplanÄ±r.")

        deck_options = titanic.loc[titanic["Pclass"] == pclass, "Deck_letter"].unique().tolist()
        deck_letter = st.selectbox("GÃ¼verte Harfi ğŸš¢", options=(deck_options), index=deck_letter_holder)

        submit, _, _, _, randomizer = st.columns(5)

        if submit.button("GÃ¶nder âœ…"):
            if age == 0:
                st.warning("LÃ¼tfen gerekli alanlarÄ± doldurun â¬†ï¸")
            else:
                st.success("BaÅŸarÄ±yla GÃ¶nderildi! ğŸ‘")
                success_control = True

        if success_control:
            # Bir dizi skaler deÄŸeri iÃ§eren bir sÃ¶zlÃ¼k oluÅŸturun ve bir indeks belirtin
            veri = {
                'Pclass': [pclass],
                'Age': [age],
                'SibSp': [sib_sp],
                'Parch': [parch],
                'Fare': [fare],
                'NumFamily': [num_family],
                'Sex_female': [0],
                'Sex_male': [0],
                'Embarked_C': [0],
                'Embarked_Q': [0],
                'Embarked_S': [0],
                'Deck_letter_A': [0],
                'Deck_letter_B': [0],
                'Deck_letter_C': [0],
                'Deck_letter_D': [0],
                'Deck_letter_E': [0],
                'Deck_letter_F': [0],
                'Deck_letter_G': [0],
                'Deck_letter_U': [0],
            }

            # DataFrame iÃ§in bir indeksi belirtin
            indeks = [0]  # Ä°stenirse indeksi ayarlayabilirsiniz

            df = pd.DataFrame(veri, index=indeks)

            embarked = embarked[0]
            df[f"Embarked_{embarked}"] = 1

            sex=sex.replace("Erkek","Male")
            sex=sex.replace("KadÄ±n","Female")
            
            df[f"Sex_{sex.lower()}"] = 1

            df[f"Deck_letter_{deck_letter}"] = 1

            # Load the model from the pickle file
            with open('model.pkl', 'rb') as file:
                model = pickle.load(file)
            # YÃ¼klenmiÅŸ modeli kullanarak tahminler yapÄ±n
            tahminler = model.predict(df)

            image_place = st.empty()



            # Specify the directory where your files are located
            alive_directory_path = "alive"
            dead_directory_path = "dead"

            # List all files in the directory
            alive_files = os.listdir(alive_directory_path)

            # Filter files to exclude directories (if any)
            alive_files = [file for file in alive_files if os.path.isfile(os.path.join(alive_directory_path, file))]

            # List all files in the directory
            dead_files = os.listdir(dead_directory_path)

            # Filter files to exclude directories (if any)
            dead_files = [file for file in dead_files if os.path.isfile(os.path.join(dead_directory_path, file))]


            if tahminler[0] == 0:
                st.write("ğŸŒŠ Maalesef! GÃ¶rÃ¼nÃ¼ÅŸe gÃ¶re cankurtaran botuna yetiÅŸemediniz. Ancak unutmayÄ±n, hepsi eÄŸlence amaÃ§lÄ±!")
                chosen_dead_file = os.path.join(dead_directory_path, random.choice(dead_files))
                image_place.image(chosen_dead_file, width=675)
            else:
                st.write("ğŸ‰ Tebrikler! Titanik macerasÄ±nÄ± saÄŸ salim atlattÄ±nÄ±z! Åimdi, anlatacak heyecan verici hikayeler hayal edin!")                
                chosen_alive_file = os.path.join(alive_directory_path, random.choice(alive_files))
                image_place.image(chosen_alive_file, width=675)


    st.write("Tahmin ediyorum ki Titanic verilerinde gizlenen sÄ±rlarÄ± aÃ§Ä±ÄŸa Ã§Ä±karmak iÃ§in sabÄ±rsÄ±zlanÄ±yorsunuz, Ã¶yle deÄŸil mi? Ä°ÅŸte harika grafiklerle dolu heyecan verici bir veri yolculuÄŸuna hazÄ±rlanÄ±n!")

    with st.expander("Veri GÃ¶rselleÅŸtirmeye HazÄ±r MÄ±sÄ±nÄ±z? ğŸ“Š"):
        st.write(
            "Can yeleklerinizi sÄ±kÄ±ca tutun, Ã§Ã¼nkÃ¼ Titanic'in verileriyle heyecan dolu bir yolculuÄŸa Ã§Ä±kmak Ã¼zereyiz!"
        )

        st.markdown(
            "ğŸ‰ **Titanik'in SÄ±rlarÄ±nÄ± KeÅŸfet**: Titanic'te Sherlock Holmes gibi hissedin! Yolcu sÄ±nÄ±fÄ±, cinsiyet ve yaÅŸÄ±n kimin hayatta kalacaÄŸÄ±na nasÄ±l etki ettiÄŸini keÅŸfedeceÄŸiz. Gizemleri aÃ§Ä±ÄŸa Ã§Ä±karmak iÃ§in hazÄ±r olun!"
        )

        st.markdown(
            "ğŸš€ **Grafiklerle Patlama YapÄ±n**: Gizli silahÄ±mÄ±z? GÃ¼Ã§lÃ¼ grafikler! Onlar, Titanic'in tarihine sihirli pencereler gibidir. KoltuklarÄ±nÄ±zÄ± sÄ±kÄ±ca baÄŸlayÄ±n, Ã§Ã¼nkÃ¼ bir roket yolculuÄŸuna Ã§Ä±kÄ±yoruz!"
        )

        st.markdown(
            "ğŸ’¡ **GÃ¶rÃ¼ÅŸler Elde Edin**: Bu gÃ¶rselleÅŸtirmeler, Titanic'in tarihini bile ilginÃ§ bulacak Jack ve Rose gibi insanlara bile ilginÃ§ gelecek bilgiler saÄŸlayacak. Bu veri yolculuÄŸuna hazÄ±r mÄ±sÄ±nÄ±z? Titanic'in sÄ±rlarÄ± sizi bekliyor!"
        )

        st.write("'Grafik OluÅŸtur' dÃ¼ÄŸmesine tÄ±klayÄ±n ve yolculuÄŸa baÅŸlayalÄ±m!")

        bins = list(range(0, 81, 5))  # 0 ile 80 arasÄ±nda 5 birimlik aralÄ±klarla bÃ¶lmeler oluÅŸturur

        # pd.cut kullanarak veriyi belirtilen bÃ¶lmelere kategorize eder
        titanic['YaÅŸ AralÄ±ÄŸÄ±'] = pd.cut(titanic['Age'], bins=bins, right=True)

        bins = list(range(0, 300, 20))  # 0 ile 300 arasÄ±nda 20 birimlik aralÄ±klarla bÃ¶lmeler oluÅŸturur

        # pd.cut kullanarak veriyi belirtilen bÃ¶lmelere kategorize eder
        titanic['Bilet FiyatÄ± AralÄ±ÄŸÄ±'] = pd.cut(titanic['Fare'], bins=bins, right=True)

        st.write("EÄŸer Titanik veri kÃ¼mesinin gerÃ§ek istatistikleri sizi meraklandÄ±rÄ±yorsa, birlikte dalalÄ±m.")

        user_hue = st.selectbox("Renk kodlamasÄ± iÃ§in ne kullanmalÄ±yÄ±z?", options=("Yok", "Kurtulanlar", "Yolcu SÄ±nÄ±fÄ±", "Cinsiyet", "YaÅŸ AralÄ±ÄŸÄ±", "KardeÅŸler & EÅŸler", "Anne & Babalar", "Bilet FiyatÄ± AralÄ±ÄŸÄ±", "BiniÅŸ LimanÄ±", "Gemi KatÄ± Harfi"))
        user_x = st.selectbox("X ekseni iÃ§in bir deÄŸer seÃ§in", options=("Kurtulanlar", "Yolcu SÄ±nÄ±fÄ±", "Cinsiyet", "KardeÅŸler & EÅŸler", "Ebeveynler & Ã‡ocuklar", "BiniÅŸ LimanÄ±", "Gemi KatÄ± Harfi"))

        if user_hue == "Yok":
            user_hue = None

        titanic.Survived = titanic.Survived.replace([1, 0], ["Kurtulanlar ğŸ˜Š", "Kurtulamayanlar ğŸ˜¥"])
        titanic.Sex = titanic.Sex.replace(["male","female"], ["Erkek", "KadÄ±n"])

        titanic = titanic.rename(columns={"Survived":"Kurtulanlar","Pclass": "Yolcu SÄ±nÄ±fÄ±", "SibSp": "KardeÅŸler & EÅŸler", "Parch": "Ebeveynler & Ã‡ocuklar", "Embarked": "BiniÅŸ LimanÄ±","Deck_letter":"Gemi KatÄ± Harfi","Sex":"Cinsiyet"})
        fig = plt.figure()
        plot_df = titanic.copy()
        sns.countplot(data=plot_df, x=user_x, hue=user_hue)
        if st.button("Grafik OluÅŸtur"):
            st.pyplot(fig)



